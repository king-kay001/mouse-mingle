"use strict";OW.ajaxUserListLoader=function(listType,page,itemCount,limit){const cont="#search-user-list-loader";let nextPage=0;OW.loadComponent("MOUSE_CMP_UserList",[listType,page,limit],cont),$(window).scroll((function(){var diff;if($(document).height()-($(window).scrollTop()+$(window).height())<100){nextPage=++page;const offset=(nextPage-1)*limit;if(itemCount<offset)return;OW.loadComponent("MOUSE_CMP_UserList",[listType,nextPage,limit],(function(html){$(cont).find(".ow_user_list").append($(html).html())}))}}))};const findAndShowChatImage=e=>{let pictureItem=e.target.closest(".ow_dialog_picture_item");if(pictureItem){e.preventDefault();let chatImage=pictureItem.querySelector("div > div > p > a > img");chatImage&&OW.showImageInFloatBox(chatImage.src)}};function OW_Mouse(params){$.extend(this,{lastFetchTime:null,notificationsData:null,notifyUrlList:null,gift:function(userId,userName){return OW.ajaxFloatBox("VIRTUALGIFTS_CMP_SendGift",{recipientId:userId},{width:580,title:OW.getLanguageText("virtualgifts","send_gift_to",{user:userName})})},setNotificationsData:function(data){this.notificationsData=data,this.lastFetchTime=Date.now()},checkConsoleUpdate:function(){const cls=OW.Console;for(const key in cls.items)if(cls.items.hasOwnProperty(key)){const item=cls.items[key],itemData=item.data;if(itemData&&this.notifyUrlList[key]){const counter=itemData.get("counter");if(console.log(item),counter.new>0){let msg=OW.getLanguageText("mekirim",key+"_notification_counter",{counter:itemData.countNew,url:this.notifyUrlList[key]});OW.info(msg)}}}},showNotification:function(){this.checkConsoleUpdate()}},params);const model=this;OW.bind("mouse.gift_click",(function(userId,userName){model.sendGift(userId,userName)})),OW.bind("mouse.edit_user_question",(function(fieldName){const questionBox="#user-edit-box-"+fieldName,inputBox="#user-edit-box-"+fieldName+"-content",submitBtn="#user-edit-box-"+fieldName+"-submit",floatbox=new OW_FloatBox({$title:$(questionBox).find(".ow_user_question_name label").text(),$contents:$(inputBox),width:"550px"}),getLabel=function(v){return'label[for="input_editForm_'+fieldName+"_"+v+'"]'};floatbox.bind("close",(function(){const input=$(inputBox).find(".ow_user_question_input_field"),display=$(questionBox).find(".ow_user_question_value"),presentation=$(questionBox).data("presentation");switch(presentation){case"text":case"textarea":case"email":display.text(input.val());break;case"age":display.text($(inputBox).find('input[name="'+fieldName+'"]').val());break;case"radio":const value=$(inputBox).find('input[name="'+fieldName+'"]:checked').val();display.text($(inputBox).find(getLabel(value)).text());break;case"select":case"fselect":display.text(input.find('option[value="'+input.val()+'"]').text());break;case"multicheckbox":const selectedCheckboxes=$(inputBox).find('input[type="checkbox"]:checked'),checklist=selectedCheckboxes.map((function(){return $(inputBox).find(getLabel($(this).val())).text()})).get();display.text(checklist.join(", "))}})),$(submitBtn).click((function(){floatbox.close({sender:"button",button:this})}))})),OW.getPing().addCommand("mouse.ping_command",{params:{},before:function(){this.params.lastFetchTime=model.lastFetchTime},after:function(data){model.setNotificationsData(data),model.showNotification()}}).start(model.pingInterval),OW.bind("mouse.user_album_photos",(function(albumId,showFooter=!0){const self=$.extend(this,{contentBox:"#ow-album-photos-"+albumId,closeBtn:"#ow-floatbox-close-"+albumId});OW.loadComponent("MOUSE_CMP_UserPhotoAlbumPhotos",[albumId,showFooter],$(self.contentBox)),self.floatbox=new OW_FloatBox({$title:"",$contents:$(self.contentBox),width:"550px"}),$(self.closeBtn).click((function(){self.floatbox.close()}))})),OW.bind("mouse.bookmark_click",(function(userId){const elem=$(this);BOOKMARKS.markState(userId,(function(data,textStatus,jqXHR){!0===data.mark?(OW.info(OW.getLanguageText("mekirim","marked_notify_message")),$(elem).addClass("active")):(OW.info(OW.getLanguageText("mekirim","unmarked_notify_message")),$(elem).removeClass("active"))}))}))}document.addEventListener("DOMContentLoaded",()=>{let floatChatContainer=document.querySelector("#dialogsContainer");floatChatContainer&&floatChatContainer.addEventListener("click",findAndShowChatImage);let mailboxLog=document.querySelector("#conversationLog");mailboxLog&&mailboxLog.addEventListener("click",findAndShowChatImage)}),OW.Mouse=null,OW.NueSignUp=function(params){Object.assign(this,params),this.form=owForms[this.formName],this.questionsArray=Object.values(this.questions),this.activeElement=null,this.completed=[];const form=$("#"+this.id),controls=form.find(".ow_nuesignup_control"),btnLogin=controls.find(".btn-nuesignup-login"),btnNext=controls.find(".btn-nuesignup-next"),btnSubmit=$(".btn-nuesignup-submit",controls);this.init=function(){this.activeElement=this.getFirstQuestion();let cont=form.hide().find(".ow_nuesignup_questions");$(".input-wrap",cont).hide(),form.show(),this.showNextQuestion(),cont.removeClass("ow_hidden"),btnNext.click(()=>this.submitQuestion())},this.getFirstQuestion=function(){return this.questionsArray.length>0?this.questionsArray[0]:null},this.getLastQuestion=function(){return this.questionsArray.length>0?this.questionsArray[this.questionsArray.length-1]:null},this.getNextQuestion=function(currentQuestion){const index=this.questionsArray.indexOf(currentQuestion);return-1!==index&&index<this.questionsArray.length-1?this.questionsArray[index+1]:null},this.submitQuestion=function(){const element=this.getActiveElement();if(!element)return;element.removeErrors();try{element.validate()}catch(e){return void this.handleValidationError(element,e)}this.completed.push(this.activeElement),form.find(".input-wrap.input-field-"+element.name).hide();const nextQuestion=this.getNextQuestion(this.activeElement);nextQuestion&&(this.activeElement=nextQuestion,this.showNextQuestion())},this.handleValidationError=function(element,error){element.input.focus(),OW.error(this.validateErrorMessage?this.validateErrorMessage:error)},this.showNextQuestion=function(){const nextElem=this.getActiveElement();nextElem&&(form.find(".input-wrap.input-field-"+nextElem.name).show(),nextElem.input.focus()),this.updateButtonVisibility()},this.updateButtonVisibility=function(){this.isFirst()?(btnNext.show(),btnLogin.show(),btnSubmit.hide()):this.isLast()?(btnNext.hide(),btnLogin.hide(),btnSubmit.show()):(btnNext.show(),btnLogin.hide(),btnSubmit.hide())},this.getActiveElement=function(){const activeQuestion=this.getActiveQuestion();if(activeQuestion&&void 0!==this.form.elements[activeQuestion])return this.form.elements[activeQuestion]},this.getActiveQuestion=function(){return this.activeElement},this.isLast=function(){return this.activeElement===this.getLastQuestion()},this.isFirst=function(){return this.activeElement===this.getFirstQuestion()},this.init()};